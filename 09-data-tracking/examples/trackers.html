<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Tracking the Trackers</title>

    <!-- 
    Title: Tracking the Trackers
    Author: Owen Mundy
    Date: 2024
    License: MIT
    -->

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">


    <!-- Open Graph tags for FB link previews
    https://developers.facebook.com/docs/sharing/webmasters -->
    <meta property="og:url" content="https://omundy.github.io/critical-web-design-book/09-data-tracking/examples/trackers.html" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Critical Web Design - Tracking the Trackers" />
    <meta property="og:description" content="Explore how others store and access your data to track and manipulate you across different websites, browsers, and devices." />
    <meta property="og:image" content="https://omundy.github.io/critical-web-design-book/assets/img/previews/09/rick-roll.png" />


    <style>
        .example {
            border: 1px solid #ccc;
            padding: 12px;
            background-color: #eee;
            border-radius: 5px;
        }

        .example code {
            display: block;
            white-space: pre-wrap
        }
    </style>
</head>
<body>



    <div class="container my-3">

        <div class="row">
            <div class="col">
                <h2 class="mt-3">Have You Been Identified?</h2>

                <p>Explore how companies, and others store and access your data to track and manipulate you across different websites, browsers, and devices.</p>

                <small class="d-block mt-2">‚ö†Ô∏è This page contains several web tracking methods and is for testing only. We don't save any information, but the trackers on the page probably will. Opening it in an incognito window with ad and / or tracker blockers disabled will allow you to see most results.</small>
            </div>
        </div>





        <div class="row mt-5">
            <div class="col-12 col-md-2">
                <h4>Link Tracking</h4>
            </div>
            <div class="col-12 col-md-5">

                Link tracking is easy to spot and avoid. If you click an ad or share a website extra URL parameters (see Module 5.3) are added to the end of the link address. Parameters like <b>utm_source</b>, <b>utm_campaign</b>, and others are used by analytics and advertising tools to track the effectiveness of their marketing campaigns. Find and click on an online ad to see one in action.

                <small class="d-block mt-2">‚ö†Ô∏è You can usually delete everything after the "?" whenever you use a <b>utm_*</b> link.</small>
                <small class="d-block mt-2">‚ö†Ô∏è Link tracking <a href="https://blog.hootsuite.com/how-to-use-utm-parameters/">does not require consent</a> under the GDPR like cookies and third party tracking pixels.</small>

                <!-- 
                Resources
                https://en.wikipedia.org/wiki/UTM_parameters
                https://blog.hootsuite.com/how-to-use-utm-parameters/
                https://developers.facebook.com/docs/instagram/ads-api/guides/url-tags-for-tracking/
                -->

            </div>
            <div class="col-12 col-md-5 example">

                <div>Example 1:</div>
                <code><a href="https://www.example.com/page?utm_content=buffercf3b2&utm_medium=social&utm_source=snapchat.com&utm_campaign=buffer">https://www.example.com/page?utm_content=buffercf3b2&utm_medium=social&utm_source=snapchat.com&utm_campaign=buffer</a>
                </code>

                <div class="mt-3">Example 2 (a sample of your data):</div>
                <code class="elelink"></code>
            </div>
        </div>





        <div class="row mt-5">
            <div class="col-12 col-md-2">
                <h4>Cookies</h4>
            </div>
            <div class="col-12 col-md-5">
                <p>
                    Cookies are probably the most well-known method for identifying you online. A cookie can be set by Javascript or a web server, and will usually contain a string of characters that identifies you, for better or worse. Without cookies websites cannot authenticate or identify you to remember you are logged in or store your preferences. However, this also allows you to be tracked using only this identifier. This page has set several cookies thanks to all the embedded examples. To see them:
                </p>

                <ol>
                    <li>Open DevTools > Applications</li>
                    <li>Expand Storage > Cookies</li>
                    <li>The cookies set by this page begin with "cwd-", but all others, like "_ga" (Google Analytics), are set by trackers </li>
                </ol>

                <small class="d-block mt-2">‚ö†Ô∏è Any cookie can be edited or deleted. If you delete a cookie used for authentication you may need to login again.</small>
            </div>
            <div class="col-12 col-md-5 example">
                <div>Example cookies (refresh to update)</div>
                <code class="elecookie"></code>
            </div>
        </div>









        <div class="row mt-5">
            <div class="col-12 col-md-2">
                <h4>Embedded Widgets</h4>
            </div>
            <div class="col-12 col-md-5">
                Any script you embed on your web page can potentially access users' data. Even a simple sharing button like this one from Facebook.
                <ol>
                    <li>Open DevTools > Applications</li>
                    <li>Expand Storage > Cookies</li>
                    <li>Look under the domain column for ".facebook.com"</li>
                </ol>
            </div>
            <div class="col-12 col-md-5 example">

                <!-- 
                Resources:
                https://developers.facebook.com/docs/plugins/share-button/
                -->
                <div id="fb-root"></div>
                <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v19.0&appId=189746494413987" nonce="Q1uUfeVv"></script>

                <div class="fb-share-button" data-href="https://omundy.github.io/critical-web-design-book/09-data-tracking/examples/trackers.html" data-layout="" data-size=""><a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fomundy.github.io%2Fcritical-web-design-book%2F09-data-tracking%2Fexamples%2Ftrackers.html&amp;src=sdkpreparse" class="fb-xfbml-parse-ignore">Share</a></div>

            </div>
        </div>




        <div class="row mt-5">
            <div class="col-12 col-md-2">
                <h4>Embedded Media</h4>
            </div>
            <div class="col-12 col-md-5">
                YouTube and other embedded media can also access your data.
                <ol>
                    <li>Open DevTools > Applications</li>
                    <li>Expand Storage > Cookies</li>
                    <li>Select the cookie with the name _ga (Google Analytics)</li>
                </ol>
            </div>
            <div class="col-12 col-md-5 example">
                <div class="ratio ratio-4x3">
                    <iframe width="560" height="315" src="https://www.youtube.com/embed/dQw4w9WgXcQ?si=_U5wln0rCHoUl1Jh" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                </div>
            </div>
        </div>




        <div class="row mt-5">
            <div class="col-12 col-md-2">
                <h4>Meta Tracking Pixel</h4>
            </div>
            <div class="col-12 col-md-5" style="min-height: 200px;">
                You can't see it because it's invisible, but this 1x1 pixel image, a.k.a. the Meta Tracking Pixel is one of the sneakiest forms of tracking out there. It works on emails
            </div>
            <div class="col-12 col-md-5 example">

                <!-- 
                Resources:
                https://blog.hootsuite.com/facebook-pixel/
                https://www.facebook.com/business/help/964258670337005?id=1205376682832142
                -->

                <!-- Owen's Tracking Pixel -->
                <!-- Meta Pixel Code -->
                <script>
                    !function (f, b, e, v, n, t, s) {
                        if (f.fbq) return; n = f.fbq = function () {
                            n.callMethod ?
                                n.callMethod.apply(n, arguments) : n.queue.push(arguments)
                        };
                        if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
                        n.queue = []; t = b.createElement(e); t.async = !0;
                        t.src = v; s = b.getElementsByTagName(e)[0];
                        s.parentNode.insertBefore(t, s)
                    }(window, document, 'script',
                        'https://connect.facebook.net/en_US/fbevents.js');
                    fbq('init', '893511094044886');
                    fbq('track', 'PageView');
                </script>
                <noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=893511094044886&ev=PageView&noscript=1" /></noscript>
                <!-- End Meta Pixel Code -->


            </div>
        </div>


    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <script src="../../assets/js/fs-environment.js"></script>
    <script>

        async function showLink() {
            const elelink = document.querySelector('.elelink');
            let url = "https://www.example.com/page?"
            try {
                let browser = await Environment.getBrowserName();
                if (browser) url += `browser=${browser}`
                let platform = await Environment.getPlatform();
                if (platform) url += `&platform=${platform}`
                let language = await Environment.getBrowserLanguage();
                if (language) url += `&language=${language}`
                let { level, charging } = await Environment.getBattery();
                if (level) url += `&battery=${level}%`
                if (charging) url += `&charging=${charging}`

                let geo = await Environment.getGeoLocation();
                if (geo.ip) url += `&ip=${geo.ip}`
                if (geo.isp) url += `&isp=${geo.isp}`
                if (geo.city) url += `&city=${geo.city}`
                if (geo.region) url += `&amp;region=${geo.region}`
                if (geo.country) url += `&country=${geo.country}`
                if (geo.flag) url += `&flag=${geo.flag}`
                if (geo.continent) url += `&continent=${geo.continent}`
                if (geo.lat) url += `&lat=${geo.lat}`
                if (geo.lng) url += `&lng=${geo.lng}`
                if (geo.timezone) url += `&timezone=${geo.timezone}`
                if (geo.currency) url += `&amp;currency=${geo.currency}`
            } catch (err) {
                console.log("err", err)
            } finally {
                // console.log("url", url)
                elelink.innerHTML = `<a href="https://www.example.com/page?browser=${url}">${url}</a>`;
            }



        }

        async function showCookie() {
            // references
            const elecookie = document.querySelector('.elecookie');
            let today = new Date();
            today.setTime(today.getTime() + (365 * 24 * 60 * 60 * 1000));
            let message = "cwd-message",
                previous = "cwd-previous",
                visited = "cwd-visited"

            // look for previous cookie
            let cookieArr = document.cookie.split("; ")
            console.log(cookieArr)
            let previousVisit = cookieArr
                .find((row) => row.startsWith(visited + "="))
                ?.split("=")[1];

            if (previousVisit) {
                document.cookie = `${previous}=${previousVisit}; expires=${today.toUTCString()}; path=/`;
            }


            document.cookie = `${message}=Hello!ü§£; expires=${today.toUTCString()}; path=/`;
            document.cookie = `${visited}=${today.toUTCString()}; expires=${today.toUTCString()}; path=/`;


            let cookieData =
                `${message}=${cookieArr
                    .find((row) => row.startsWith(message + "="))
                    ?.split("=")[1]} \n${previous}=${cookieArr
                        .find((row) => row.startsWith(previous + "="))
                        ?.split("=")[1]} \n${visited}=${cookieArr
                            .find((row) => row.startsWith(visited + "="))
                            ?.split("=")[1]}`

            elecookie.textContent = cookieData;
        }

        async function main() {
            showLink()
            showCookie()
        }
        main()





    </script>

</body>
</html>